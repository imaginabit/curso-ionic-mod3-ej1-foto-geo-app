<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title> {{titulo}} </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">{{titulo}}</ion-title>
    </ion-toolbar>
  </ion-header>

  <div id="container">
    <!-- Bot√≥n para tomar foto -->
    <ion-button expand="full" (click)="tomarFoto()"> Tomar Foto </ion-button>

    <!-- Campo descripci√≥n -->
    <ion-item>
      <ion-label position="floating">Descripci√≥n</ion-label>
      <ion-textarea [(ngModel)]="descripcion"></ion-textarea>
    </ion-item>

    <!-- Vista previa de la foto -->
    <ion-img class="foto-preview" [src]="foto" *ngIf="foto"></ion-img>

    <!-- Bot√≥n eliminar foto -->
    <ion-button
      fill="clear"
      expand="full"
      color="danger"
      *ngIf="foto"
      (click)="eliminarFoto()"
    >
      Eliminar Foto
    </ion-button>

    <!-- Bot√≥n guardar (por ahora solo console.log) -->
    <ion-button
      expand="full"
      color="success"
      (click)="guardarRegistro()"
      [disabled]="!formularioValido"
    >
      Guardar Registro
    </ion-button>

    <!-- Secci√≥n: Nuevo Registro -->
    <ion-card>
      <ion-card-content>
        <div class="ubicacion-info" *ngIf="tieneUbicacion">
          <ion-text color="success">
            <h4>üìç Ubicaci√≥n obtenida</h4>
            <p>
              {{coordenadas!.latitude.toFixed(6)}},
              {{coordenadas!.longitude.toFixed(6)}}
            </p>
          </ion-text>
        </div>

        <div class="ubicacion-info" *ngIf="cargandoUbicacion">
          <ion-text color="warning">
            <p>üîç Obteniendo ubicaci√≥n...</p>
          </ion-text>
        </div>
      </ion-card-content>

      <ion-button
        expand="full"
        fill="outline"
        color="secondary"
        (click)="obtenerUbicacion()"
        [disabled]="cargandoUbicacion"
      >
        {{cargandoUbicacion ? 'Obteniendo ubicaci√≥n...' : 'Obtener Ubicaci√≥n
        GPS'}}
      </ion-button>
    </ion-card>

    <ion-card *ngIf="registros.length > 0">
      <ion-card-header>
        <ion-card-title
          >Registros Guardados ({{registros.length}})</ion-card-title
        >
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let registro of registros">
            <ion-grid>
              <ion-row>
                <!-- Columna de imagen -->
                <ion-col size="4">
                  <ion-img [src]="registro.photo" class="registro-imagen">
                  </ion-img>
                </ion-col>

                <!-- Columna de informaci√≥n -->
                <ion-col size="6">
                  <div class="registro-info">
                    <h3>{{registro.description}}</h3>
                    <p class="date">üìÖ {{registro.date}}</p>
                    <p class="coordenadas">üìç  {{registro.coordinates!.latitude.toFixed(6)}},
              {{registro.coordinates!.longitude.toFixed(6)}}</p>
                  </div>
                </ion-col>



                <!-- Columna de bot√≥n eliminar -->
                <ion-col size="2" class="ion-text-center">
                  <ion-button
                    fill="clear"
                    color="danger"
                    size="small"
                    (click)="eliminarRegistro(registro.id)"
                  >
                    üóëÔ∏è
                  </ion-button>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- Mensaje cuando no hay registros -->
    <ion-card *ngIf="registros.length === 0">
      <ion-card-content class="ion-text-center">
        <ion-text color="medium">
          <h4>No hay registros guardados</h4>
          <p>Toma tu primera foto con ubicaci√≥n para comenzar</p>
        </ion-text>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
